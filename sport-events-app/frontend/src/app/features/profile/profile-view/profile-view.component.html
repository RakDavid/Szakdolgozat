<div class="profile-container" *ngIf="!loading && user">
  <!-- Profile Header -->
  <div class="profile-header">
    <div class="profile-banner" [style.backgroundImage]="getBannerBackground()"></div>
    <div class="profile-info">
      <div class="profile-avatar-wrapper">
        <div class="profile-avatar" *ngIf="!user.profile_picture">
          {{ getUserInitials() }}
        </div>
        <img 
          *ngIf="user.profile_picture" 
          [src]="user.profile_picture" 
          alt="Profile Picture"
          class="profile-avatar-img"
        />
      </div>
      <div class="profile-details">
        <h1 class="profile-name">{{ user.full_name }}</h1>
        <p class="profile-username">{{ '@' + user.username }}</p>
        <p class="profile-member-since">ğŸ“… Tag {{ getMemberSince() }} Ã³ta</p>
      </div>
      <div *ngIf="isOwnProfile" class="profile-actions">
        <button class="btn btn-primary" (click)="editProfile()" [routerLink]="['/profile/edit']" [queryParams]="{tab: 'personal'}">
          âœï¸ Profil szerkesztÃ©se
        </button>
      </div>
    </div>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="alert alert-error">
    {{ errorMessage }}
  </div>

  <!-- Profile Content -->
  <div class="profile-content">
    <!-- Left Column -->
    <div class="profile-main">
      <!-- About Section -->
      <div class="section-card">
        <h2 class="section-title">RÃ³lam</h2>
        <div *ngIf="user.bio" class="bio-text">
          {{ user.bio }}
        </div>
        <div *ngIf="!user.bio" class="empty-message">
          MÃ©g nincs bemutatkozÃ¡s. Szerkeszd a profilod Ã©s adj hozzÃ¡ egy bemutatkozÃ¡st!
        </div>
      </div>

      <!-- Sport Preferences -->
      <div class="section-card">
        <div class="section-header-with-action">
          <h2 class="section-title" style="margin-bottom: 0;">SportÃ¡g preferenciÃ¡k</h2>
          <button *ngIf="isOwnProfile" class="btn btn-primary" [routerLink]="['/profile/edit']" [queryParams]="{tab: 'preferences'}">
            âœï¸ SzerkesztÃ©s
          </button>
        </div>
        <div *ngIf="sportPreferences.length > 0" class="preferences-list">
          
          <div *ngFor="let pref of sportPreferences" class="preference-item">
            <div class="preference-header">
              
              <span class="preference-sport">
                {{ getSportIcon(pref.sport_type) }} {{ getSportName(pref.sport_type) }}
              </span>
              
              <span class="preference-level" [class]="pref.skill_level">
                {{ getSkillLevelLabel(pref.skill_level) }}
              </span>
            </div>
            
            <div class="preference-interest">
              <span class="interest-label">Ã‰rdeklÅ‘dÃ©si szint:</span>
              <div class="interest-bar">
                <div 
                  class="interest-fill" 
                  [style.width.%]="pref.interest_level * 10"
                ></div>
              </div>
              <span class="interest-value">{{ pref.interest_level }}/10</span>
            </div>
          </div>

        </div>
        
        <div *ngIf="sportPreferences.length === 0" class="empty-message">
          MÃ©g nincs megadva sportÃ¡g preferencia. Adj hozzÃ¡ preferenciÃ¡kat a jobb ajÃ¡nlÃ¡sokÃ©rt!
        </div>
      </div>

      <!-- Statistics -->
      <div class="section-card">
        <h2 class="section-title">StatisztikÃ¡k Ã©s EsemÃ©nyek</h2>
        
        <div class="stats-grid">
          <div class="stat-item" [class.clickable]="isOwnProfile" [class.active]="showCreated" (click)="toggleCreatedEvents()">
            <div class="stat-icon">ğŸ“</div>
            <div class="stat-value">{{ user.created_events_count || 0 }}</div>
            <div class="stat-label">LÃ©trehozott esemÃ©ny</div>
          </div>
          <div class="stat-item" [class.clickable]="isOwnProfile" [class.active]="showParticipated" (click)="toggleParticipatedEvents()">
            <div class="stat-icon">ğŸƒ</div>
            <div class="stat-value">{{ user.participated_events_count || 0 }}</div>
            <div class="stat-label">RÃ©szvÃ©tel</div>
          </div>
        </div>

        <div class="stats-dropdown" *ngIf="showCreated || showParticipated">
          <div *ngIf="loadingEvents" class="dropdown-loading">
            <div class="spinner small"></div> BetÃ¶ltÃ©s...
          </div>

          <div *ngIf="showCreated && !loadingEvents" class="dropdown-content">
            <h4 class="dropdown-title">SajÃ¡t szervezÃ©sÅ± esemÃ©nyeim</h4>
            <div class="dropdown-list">
              <a *ngFor="let event of createdEvents" [routerLink]="['/events', event.id]" class="dropdown-item">
                <div class="dropdown-event-main">
                  <span class="dropdown-event-date">{{ event.start_date_time | date:'yyyy.MM.dd.' }}</span>
                  <span class="dropdown-event-title">{{ event.title }}</span>
                </div>
              </a>
              <div *ngIf="createdEvents.length === 0" class="dropdown-empty">MÃ©g nem hoztÃ¡l lÃ©tre esemÃ©nyt.</div>
            </div>
          </div>

          <div *ngIf="showParticipated && !loadingEvents" class="dropdown-content">
            <h4 class="dropdown-title">EsemÃ©nyek, amiken rÃ©szt vettem</h4>
            <div class="dropdown-list">
              <a *ngFor="let event of participatedEvents" [routerLink]="['/events', event.id]" class="dropdown-item">
                <div class="dropdown-event-main">
                  <span class="dropdown-event-date">{{ event.start_date_time | date:'yyyy.MM.dd.' }}</span>
                  <span class="dropdown-event-title">{{ event.title }}</span>
                </div>
              </a>
              <div *ngIf="participatedEvents.length === 0" class="dropdown-empty">MÃ©g nem jelentkeztÃ©l esemÃ©nyre.</div>
            </div>
          </div>
        </div>

      </div>
    </div>

    <!-- Sidebar -->
    <div class="profile-sidebar">
      <!-- Contact Info -->
      <div class="sidebar-card">
        <h3 class="sidebar-title">ElÃ©rhetÅ‘sÃ©g</h3>
        <div class="contact-list">
          <div class="contact-item">
            <span class="contact-icon">ğŸ“§</span>
            <span class="contact-value">{{ user.email }}</span>
          </div>
          <div class="contact-item" *ngIf="user.phone_number">
            <span class="contact-icon">ğŸ“±</span>
            <span class="contact-value">{{ user.phone_number }}</span>
          </div>
        </div>
      </div>

      <!-- Location Info -->
      <div class="sidebar-card" *ngIf="isOwnProfile && user.default_location_name">
        <h3 class="sidebar-title">AlapÃ©rtelmezett helyszÃ­n</h3>
        <div class="location-info">
          <div class="location-icon">ğŸ“</div>
          <div class="location-details">
            <div class="location-name">{{ user.default_location_name }}</div>
            <div class="location-search">
              KeresÃ©si sugÃ¡r: {{ user.default_search_radius }} km
            </div>
          </div>
        </div>
      </div>

      <!-- Quick Links -->
      <div class="sidebar-card">
        <h3 class="sidebar-title">Gyors linkek</h3>
        <div class="quick-links">
          <a routerLink="/my-events" class="quick-link">
            <span class="link-icon">ğŸ“…</span>
            <span class="link-text">SajÃ¡t esemÃ©nyek</span>
          </a>
          <a routerLink="/events" class="quick-link">
            <span class="link-icon">ğŸ”</span>
            <span class="link-text">EsemÃ©nyek bÃ¶ngÃ©szÃ©se</span>
          </a>
          <a routerLink="/create-event" class="quick-link">
            <span class="link-icon">â•</span>
            <span class="link-text">Ãšj esemÃ©ny</span>
          </a>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Loading -->
<div *ngIf="loading" class="loading-container">
  <div class="spinner"></div>
  <p>Profil betÃ¶ltÃ©se...</p>
</div>

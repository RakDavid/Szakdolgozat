<div class="my-events-container">
  <div class="page-header">
    <h1>SajÃ¡t esemÃ©nyek</h1>
    <p>A lÃ©trehozott Ã©s a jelentkezett esemÃ©nyeid egy helyen</p>
    <p>Debug: loading={{ loading }}, tab={{ activeTab }}, count={{ createdEvents.length }}</p>
  </div>

  <!-- Tabs -->
  <div class="tabs">
    <button 
      class="tab-button" 
      [class.active]="activeTab === 'created'"
      (click)="switchTab('created')"
    >
      ğŸ“ LÃ©trehozott esemÃ©nyek ({{ createdEvents.length }})
    </button>
    <button 
      class="tab-button" 
      [class.active]="activeTab === 'participating'"
      (click)="switchTab('participating')"
    >
      ğŸ‘¥ RÃ©szvÃ©telek ({{ participatingEvents.length }})
    </button>
    <button 
      class="tab-button" 
      [class.active]="activeTab === 'pending'"
      (click)="switchTab('pending')"
    >
      â³ JÃ³vÃ¡hagyÃ¡sok szÃ¼ksÃ©gesek
    </button>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="loading-container">
    <div class="spinner"></div>
    <p>EsemÃ©nyek betÃ¶ltÃ©se...</p>
  </div>

  <!-- Created Events Tab -->
  <div *ngIf="!loading && activeTab === 'created'" class="tab-content">
    <div *ngIf="createdEvents.length > 0" class="events-grid">
      <div 
        *ngFor="let event of createdEvents" 
        class="event-card"
        [routerLink]="['/events', event.id]"
      >
        <!-- KÃ©p vagy tÃ©rkÃ©p -->
        <div class="event-image-container">
          <div
            *ngIf="event.primary_image"
            class="event-image"
            [style.background-image]="'url(' + event.primary_image + ')'"
          >
          </div>
          <div
            *ngIf="!event.primary_image"
            class="event-map"
          >
            <app-map 
              [latitude]="event.latitude" 
              [longitude]="event.longitude"
              [zoom]="14"
              [height]="'200px'"
              [markers]="[{lat: event.latitude, lng: event.longitude, popup: event.location_name}]"
            ></app-map>
          </div>
          
          <div class="event-status-badge" [class]="event.status">
            {{ getStatusLabel(event.status) }}
          </div>
        </div>

        <div class="event-content">
          <div class="event-meta">
            <span class="event-sport-type">
              {{ event.sport_type_detail?.name }}
            </span>
            <span class="event-difficulty" [class]="event.difficulty">
              {{ getDifficultyLabel(event.difficulty) }}
            </span>
          </div>

          <h3 class="event-title">{{ event.title }}</h3>

          <div class="event-details">
            <div class="event-detail">
              <span class="detail-icon">ğŸ“…</span>
              {{ getEventDate(event.start_date_time) }}
            </div>
            <div class="event-detail">
              <span class="detail-icon">ğŸ•’</span>
              {{ getEventTime(event.start_date_time) }}
            </div>
            <div class="event-detail">
              <span class="detail-icon">ğŸ“</span>
              {{ event.location_name }}
            </div>
          </div>

          <div class="event-footer">
            <div class="event-participants">
              <span class="participants-icon">ğŸ‘¥</span>
              <span class="participants-text">
                {{ event.participants_count }} / {{ event.max_participants }}
              </span>
            </div>
            <div class="event-status-indicator" [class.full]="event.is_full">
              {{ event.is_full ? 'Betelt' : event.available_spots + ' hely' }}
            </div>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="createdEvents.length === 0" class="empty-state">
      <div class="empty-icon">ğŸ“</div>
      <h3>MÃ©g nincs lÃ©trehozott esemÃ©nyed</h3>
      <p>Hozz lÃ©tre egy Ãºj esemÃ©nyt Ã©s hÃ­vd meg a kÃ¶zÃ¶ssÃ©get!</p>
      <button class="btn btn-primary" routerLink="/create-event">
        â• Ãšj esemÃ©ny lÃ©trehozÃ¡sa
      </button>
    </div>
  </div>

  <!-- Participating Events Tab -->
  <div *ngIf="!loading && activeTab === 'participating'" class="tab-content">
    <div *ngIf="participatingEvents.length > 0" class="events-grid">
      <div 
        *ngFor="let event of participatingEvents" 
        class="event-card"
        [routerLink]="['/events', event.id]"
      >
        <!-- KÃ©p vagy tÃ©rkÃ©p -->
        <div class="event-image-container">
          <div
            *ngIf="event.primary_image"
            class="event-image"
            [style.background-image]="'url(' + event.primary_image + ')'"
          >
          </div>
          <div
            *ngIf="!event.primary_image"
            class="event-map"
          >
            <app-map 
              [latitude]="event.latitude" 
              [longitude]="event.longitude"
              [zoom]="14"
              [height]="'200px'"
              [markers]="[{lat: event.latitude, lng: event.longitude, popup: event.location_name}]"
            ></app-map>
          </div>
          
          <div class="event-status-badge" [class]="event.status">
            {{ getStatusLabel(event.status) }}
          </div>
          <div *ngIf="event.user_participation_status" class="participation-badge" [class]="event.user_participation_status.status">
            {{ event.user_participation_status.status === 'confirmed' ? 'âœ“ MegerÅ‘sÃ­tve' : 
               event.user_participation_status.status === 'pending' ? 'â³ FÃ¼ggÅ‘ben' : 
               event.user_participation_status.status }}
          </div>
        </div>

        <div class="event-content">
          <div class="event-meta">
            <span class="event-sport-type">
              {{ event.sport_type_detail?.name }}
            </span>
            <span class="event-difficulty" [class]="event.difficulty">
              {{ getDifficultyLabel(event.difficulty) }}
            </span>
          </div>

          <h3 class="event-title">{{ event.title }}</h3>

          <div class="event-details">
            <div class="event-detail">
              <span class="detail-icon">ğŸ“…</span>
              {{ getEventDate(event.start_date_time) }}
            </div>
            <div class="event-detail">
              <span class="detail-icon">ğŸ•’</span>
              {{ getEventTime(event.start_date_time) }}
            </div>
            <div class="event-detail">
              <span class="detail-icon">ğŸ“</span>
              {{ event.location_name }}
            </div>
          </div>

          <div class="event-footer">
            <div class="event-participants">
              <span class="participants-icon">ğŸ‘¥</span>
              <span class="participants-text">
                {{ event.participants_count }} / {{ event.max_participants }}
              </span>
            </div>
            <div class="creator-info">
              <span class="creator-label">SzervezÅ‘:</span>
              <span class="creator-name">{{ event.creator_detail?.full_name }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="participatingEvents.length === 0" class="empty-state">
      <div class="empty-icon">ğŸ‘¥</div>
      <h3>MÃ©g nem jelentkeztÃ©l esemÃ©nyekre</h3>
      <p>BÃ¶ngÃ©szd az elÃ©rhetÅ‘ esemÃ©nyeket Ã©s csatlakozz!</p>
      <button class="btn btn-primary" routerLink="/events">
        ğŸ” EsemÃ©nyek bÃ¶ngÃ©szÃ©se
      </button>
    </div>
  </div>
</div>
